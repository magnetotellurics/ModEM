# Makefile suited for building the test_FWD_MPI program
# Generated using: ./fmkmf.pl [OPTIONS] test_FWD_MPI.f90 > Makefile
# with command line options
# -p .:Classes:Classes/1D:Classes/2D:Classes/CSEM:Classes/DataIO:Classes/DataSpace:Classes/Fields:Classes/ForwardSolver:Classes/Grid:Classes/ModelOperator:Classes/ModelParameter:Classes/MPI:Classes/Receivers:Classes/Solver:Classes/Source:Classes/Transmitters:Classes/Utils
# -f90 mpif90 (compiler)
# -opt -O3 -ffree-line-length-none -Wno-all (compiler optimisation)
# -lp /usr/lib64 (linking options: path to libraries)
# -l -llapack -lblas (linking options)
# -o objs/MT3D_OO_MPI (output directory for object files)

#  Uncomment these lines to make program for Solaris OS (legacy)
# F90 = f90
# FFLAGS = -dalign -g -C -w  -L/usr/local/lib
# LIBS = -xlic_lib=sunperf
#  Uncomment these lines to make program with g95
# include Makefile.local
# OBJDIR = ./objs/3D_MT/G95Debug
# F90 = g95
# FFLAGS = -O2
# FFLAGS = -g -ftrace=frame -fbounds-check
# MPIFLAGS = -cpp # for serial code
# MODULE = -fmod=$(OBJDIR)
# LIBS = -lblas -llapack
#  Uncomment these lines to make program with Intel compiler
# include Makefile.local
# OBJDIR = ./objs/3D_MT/IFortDebug
# F90 = ifort
# FFLAGS = -O3 -parallel -openmp #-heap-arrays
# FFLAGS = -debug all -check bounds -traceback -heap-arrays
# MPIFLAGS = -cpp # for serial code
# MODULE = -module $(OBJDIR)
# LIBS = -lblas -llapack
#  Uncomment these lines to make program with PGI compiler
# include Makefile.local
# OBJDIR = ./objs/3D_MT/PGIDebug
# F90 = pgf95  # mpif90
# FFLAGS = -O3
# FFLAGS = -g -Mprof=lines -Mbounds
# MPIFLAGS = -Mpreprocess # for serial code
# MPIFLAGS = -Bstatic  -Mipa=fast  -Mextend  -Kieee -Mpreprocess -DMPI
# MODULE = -module $(OBJDIR)
# LIBS = -llapack -lblas
# LIBS = -L/usr/lib64 -llapack -lblas -lpgftnrtl -Mprof=lines

# ------------------Macro-Defs---------------------
include Makefile.local
OBJDIR = ../../objs/MT3D_OO
F90 = mpif90 
FFLAGS = -g -ffree-line-length-none -Wno-all
MPIFLAGS = -x f95-cpp-input -DMPI
MODULE = -J $(OBJDIR)
LIBS_PATH = -L/usr/lib64
LIBS = -llapack -lblas

# -------------------End-macro-Defs---------------------------
OBJ = $(OBJDIR)/Constants.o $(OBJDIR)/FileUnits.o $(OBJDIR)/String.o $(OBJDIR)/Grid1D.o $(OBJDIR)/Grid2D.o $(OBJDIR)/Grid.o $(OBJDIR)/rScalar.o $(OBJDIR)/rVector.o $(OBJDIR)/cVector.o $(OBJDIR)/cScalar.o $(OBJDIR)/MetricElements.o $(OBJDIR)/ModelParameter1D.o $(OBJDIR)/Esoln2DTM.o $(OBJDIR)/ModelParameter2D.o $(OBJDIR)/ModelParameter.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/Source.o $(OBJDIR)/PreConditioner.o $(OBJDIR)/Solver.o $(OBJDIR)/ForwardSolver.o $(OBJDIR)/ModEMControlFile.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/ModelReader.o $(OBJDIR)/rScalar3D_SG.o $(OBJDIR)/MatUtils.o $(OBJDIR)/rVector3D_SG.o $(OBJDIR)/ModelParameterCell_SG.o $(OBJDIR)/ModelReader_Weerachai.o $(OBJDIR)/cScalar3D_SG.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/MetricElements_CSG.o $(OBJDIR)/ModelOperator_MF.o $(OBJDIR)/ModelOperator_File.o $(OBJDIR)/DataEntry.o $(OBJDIR)/DataEntryFArray.o $(OBJDIR)/DataEntryMT.o $(OBJDIR)/DataEntryMT_REF.o $(OBJDIR)/DataEntryCSEM.o $(OBJDIR)/Transmitter.o $(OBJDIR)/cSparseVector3D_SG.o $(OBJDIR)/DataHandle.o $(OBJDIR)/DataHandleMT.o $(OBJDIR)/DataHandleCSEM.o $(OBJDIR)/DataHandleFArray.o $(OBJDIR)/Receiver.o $(OBJDIR)/ReceiverFullImpedance.o $(OBJDIR)/ReceiverFullVerticalMagnetic.o $(OBJDIR)/ReceiverOffDiagonalImpedance.o $(OBJDIR)/TransmitterCSEM.o $(OBJDIR)/ReceiverSingleField.o $(OBJDIR)/ReceiverFArray.o $(OBJDIR)/TransmitterMT.o $(OBJDIR)/TransmitterFArray.o $(OBJDIR)/DataFile.o $(OBJDIR)/DataFileStandard.o $(OBJDIR)/PreConditioner_MF_DC.o $(OBJDIR)/Solver_PCG.o $(OBJDIR)/DivergenceCorrection.o $(OBJDIR)/PreConditioner_MF_CC.o $(OBJDIR)/Solver_QMR.o $(OBJDIR)/ForwardSolverIT_DC.o $(OBJDIR)/Forward1D.o $(OBJDIR)/SourceMT_1D.o $(OBJDIR)/Forward2D.o $(OBJDIR)/SourceMT_2D.o $(OBJDIR)/FilterModules.o $(OBJDIR)/Dipole1D.o $(OBJDIR)/SourceCSEM_Dipole1D.o $(OBJDIR)/DeclarationMPI.o $(OBJDIR)/test_FWD_MPI.o 


all: test_FWD_MPI 

# Here is the link step 
test_FWD_MPI: $(OBJDIR) $(OBJ) 
	 $(F90) -o $(OUTDIR)/test_FWD_MPI $(OBJ) $(LIBS_PATH) $(LIBS)

# Here are the compile steps 

$(OBJDIR): 
	mkdir -p $(OBJDIR)

$(OBJDIR)/Constants.o:Classes/Utils/Constants.f90  
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Utils/Constants.f90 -o $(OBJDIR)/Constants.o

$(OBJDIR)/FileUnits.o:Classes/Utils/FileUnits.f90  
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Utils/FileUnits.f90 -o $(OBJDIR)/FileUnits.o

$(OBJDIR)/String.o:Classes/Utils/String.f90  
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Utils/String.f90 -o $(OBJDIR)/String.o

$(OBJDIR)/Grid1D.o:Classes/1D/Grid1D.f90 $(OBJDIR)/Constants.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/1D/Grid1D.f90 -o $(OBJDIR)/Grid1D.o

$(OBJDIR)/Grid2D.o:Classes/2D/Grid2D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid1D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/2D/Grid2D.f90 -o $(OBJDIR)/Grid2D.o

$(OBJDIR)/Grid.o:Classes/Grid/Grid.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid1D.o $(OBJDIR)/Grid2D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Grid/Grid.f90 -o $(OBJDIR)/Grid.o

$(OBJDIR)/rScalar.o:Classes/Fields/rScalar.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/rScalar.f90 -o $(OBJDIR)/rScalar.o

$(OBJDIR)/rVector.o:Classes/Fields/rVector.f90 $(OBJDIR)/Constants.o $(OBJDIR)/rScalar.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/rVector.f90 -o $(OBJDIR)/rVector.o

$(OBJDIR)/cVector.o:Classes/Fields/cVector.f90 $(OBJDIR)/Constants.o $(OBJDIR)/rScalar.o $(OBJDIR)/rVector.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/cVector.f90 -o $(OBJDIR)/cVector.o

$(OBJDIR)/cScalar.o:Classes/Fields/cScalar.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/rScalar.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/cScalar.f90 -o $(OBJDIR)/cScalar.o

$(OBJDIR)/MetricElements.o:Classes/ModelOperator/MetricElements.f90 $(OBJDIR)/Grid.o $(OBJDIR)/rVector.o $(OBJDIR)/rScalar.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/MetricElements.f90 -o $(OBJDIR)/MetricElements.o

$(OBJDIR)/ModelParameter1D.o:Classes/1D/ModelParameter1D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid1D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/1D/ModelParameter1D.f90 -o $(OBJDIR)/ModelParameter1D.o

$(OBJDIR)/Esoln2DTM.o:Classes/2D/Esoln2DTM.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid2D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/2D/Esoln2DTM.f90 -o $(OBJDIR)/Esoln2DTM.o

$(OBJDIR)/ModelParameter2D.o:Classes/2D/ModelParameter2D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid2D.o $(OBJDIR)/Esoln2DTM.o $(OBJDIR)/Grid1D.o $(OBJDIR)/ModelParameter1D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/2D/ModelParameter2D.f90 -o $(OBJDIR)/ModelParameter2D.o

$(OBJDIR)/ModelParameter.o:Classes/ModelParameter/ModelParameter.f90 $(OBJDIR)/Constants.o $(OBJDIR)/rScalar.o $(OBJDIR)/rVector.o $(OBJDIR)/Grid2D.o $(OBJDIR)/ModelParameter1D.o $(OBJDIR)/ModelParameter2D.o $(OBJDIR)/Grid.o $(OBJDIR)/MetricElements.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelParameter/ModelParameter.f90 -o $(OBJDIR)/ModelParameter.o

$(OBJDIR)/ModelOperator.o:Classes/ModelOperator/ModelOperator.f90 $(OBJDIR)/Constants.o $(OBJDIR)/cVector.o $(OBJDIR)/cScalar.o $(OBJDIR)/MetricElements.o $(OBJDIR)/ModelParameter.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/ModelOperator.f90 -o $(OBJDIR)/ModelOperator.o

$(OBJDIR)/Source.o:Classes/Source/Source.f90 $(OBJDIR)/cVector.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/ModelParameter.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Source/Source.f90 -o $(OBJDIR)/Source.o

$(OBJDIR)/PreConditioner.o:Classes/ModelOperator/PreConditioner.f90 $(OBJDIR)/cVector.o $(OBJDIR)/cScalar.o $(OBJDIR)/ModelOperator.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/PreConditioner.f90 -o $(OBJDIR)/PreConditioner.o

$(OBJDIR)/Solver.o:Classes/Solver/Solver.f90 $(OBJDIR)/Constants.o $(OBJDIR)/cVector.o $(OBJDIR)/PreConditioner.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Solver/Solver.f90 -o $(OBJDIR)/Solver.o

$(OBJDIR)/ForwardSolver.o:Classes/ForwardSolver/ForwardSolver.f90 $(OBJDIR)/Constants.o $(OBJDIR)/cVector.o $(OBJDIR)/Source.o $(OBJDIR)/ModelParameter.o $(OBJDIR)/Solver.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ForwardSolver/ForwardSolver.f90 -o $(OBJDIR)/ForwardSolver.o

$(OBJDIR)/ModEMControlFile.o:./ModEMControlFile.f90 $(OBJDIR)/Constants.o $(OBJDIR)/String.o $(OBJDIR)/Grid.o $(OBJDIR)/ForwardSolver.o $(OBJDIR)/Solver.o $(OBJDIR)/Source.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) ./ModEMControlFile.f90 -o $(OBJDIR)/ModEMControlFile.o

$(OBJDIR)/Grid3D_SG.o:Classes/Grid/Grid3D_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid1D.o $(OBJDIR)/Grid2D.o $(OBJDIR)/ModEMControlFile.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Grid/Grid3D_SG.f90 -o $(OBJDIR)/Grid3D_SG.o

$(OBJDIR)/ModelReader.o:Classes/ModelParameter/ModelReader.f90 $(OBJDIR)/Grid.o $(OBJDIR)/ModelParameter.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelParameter/ModelReader.f90 -o $(OBJDIR)/ModelReader.o

$(OBJDIR)/rScalar3D_SG.o:Classes/Fields/rScalar3D_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/rScalar.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/rScalar3D_SG.f90 -o $(OBJDIR)/rScalar3D_SG.o

$(OBJDIR)/MatUtils.o:Classes/Utils/MatUtils.f90 $(OBJDIR)/Constants.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Utils/MatUtils.f90 -o $(OBJDIR)/MatUtils.o

$(OBJDIR)/rVector3D_SG.o:Classes/Fields/rVector3D_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/MatUtils.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/rScalar.o $(OBJDIR)/rScalar3D_SG.o $(OBJDIR)/rVector.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/rVector3D_SG.f90 -o $(OBJDIR)/rVector3D_SG.o

$(OBJDIR)/ModelParameterCell_SG.o:Classes/ModelParameter/ModelParameterCell_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/rScalar.o $(OBJDIR)/rVector.o $(OBJDIR)/rScalar3D_SG.o $(OBJDIR)/rVector3D_SG.o $(OBJDIR)/ModelParameter.o $(OBJDIR)/Grid1D.o $(OBJDIR)/Grid2D.o $(OBJDIR)/ModelParameter1D.o $(OBJDIR)/ModelParameter2D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelParameter/ModelParameterCell_SG.f90 -o $(OBJDIR)/ModelParameterCell_SG.o

$(OBJDIR)/ModelReader_Weerachai.o:Classes/ModelParameter/ModelReader_Weerachai.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/rScalar3D_SG.o $(OBJDIR)/ModelParameter.o $(OBJDIR)/ModelReader.o $(OBJDIR)/ModelParameterCell_SG.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelParameter/ModelReader_Weerachai.f90 -o $(OBJDIR)/ModelReader_Weerachai.o

$(OBJDIR)/cScalar3D_SG.o:Classes/Fields/cScalar3D_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/cScalar.o $(OBJDIR)/rScalar3D_SG.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/cScalar3D_SG.f90 -o $(OBJDIR)/cScalar3D_SG.o

$(OBJDIR)/cVector3D_SG.o:Classes/Fields/cVector3D_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/MatUtils.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/rScalar.o $(OBJDIR)/rScalar3D_SG.o $(OBJDIR)/rVector.o $(OBJDIR)/rVector3D_SG.o $(OBJDIR)/cVector.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/cVector3D_SG.f90 -o $(OBJDIR)/cVector3D_SG.o

$(OBJDIR)/MetricElements_CSG.o:Classes/ModelOperator/MetricElements_CSG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/MetricElements.o $(OBJDIR)/rVector3D_SG.o $(OBJDIR)/rScalar3D_SG.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/MetricElements_CSG.f90 -o $(OBJDIR)/MetricElements_CSG.o

$(OBJDIR)/ModelOperator_MF.o:Classes/ModelOperator/ModelOperator_MF.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/rScalar3D_SG.o $(OBJDIR)/cScalar3D_SG.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/rVector3D_SG.o $(OBJDIR)/MetricElements_CSG.o $(OBJDIR)/ModelParameter.o $(OBJDIR)/ModelOperator.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/ModelOperator_MF.f90 -o $(OBJDIR)/ModelOperator_MF.o

$(OBJDIR)/ModelOperator_File.o:Classes/ModelOperator/ModelOperator_File.f90 $(OBJDIR)/ModelOperator_MF.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/ModelOperator_File.f90 -o $(OBJDIR)/ModelOperator_File.o

$(OBJDIR)/DataEntry.o:Classes/DataIO/DataEntry.f90 $(OBJDIR)/Constants.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataEntry.f90 -o $(OBJDIR)/DataEntry.o

$(OBJDIR)/DataEntryFArray.o:Classes/DataIO/DataEntryFArray.f90 $(OBJDIR)/DataEntry.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataEntryFArray.f90 -o $(OBJDIR)/DataEntryFArray.o

$(OBJDIR)/DataEntryMT.o:Classes/DataIO/DataEntryMT.f90 $(OBJDIR)/DataEntry.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataEntryMT.f90 -o $(OBJDIR)/DataEntryMT.o

$(OBJDIR)/DataEntryMT_REF.o:Classes/DataIO/DataEntryMT_REF.f90 $(OBJDIR)/DataEntryMT.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataEntryMT_REF.f90 -o $(OBJDIR)/DataEntryMT_REF.o

$(OBJDIR)/DataEntryCSEM.o:Classes/DataIO/DataEntryCSEM.f90 $(OBJDIR)/DataEntry.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataEntryCSEM.f90 -o $(OBJDIR)/DataEntryCSEM.o

$(OBJDIR)/Transmitter.o:Classes/Transmitters/Transmitter.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Source.o $(OBJDIR)/ForwardSolver.o $(OBJDIR)/cVector.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Transmitters/Transmitter.f90 -o $(OBJDIR)/Transmitter.o

$(OBJDIR)/cSparseVector3D_SG.o:Classes/Fields/cSparseVector3D_SG.f90 $(OBJDIR)/Constants.o $(OBJDIR)/cVector3D_SG.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Fields/cSparseVector3D_SG.f90 -o $(OBJDIR)/cSparseVector3D_SG.o

$(OBJDIR)/DataHandle.o:Classes/DataIO/DataHandle.f90 $(OBJDIR)/Constants.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataHandle.f90 -o $(OBJDIR)/DataHandle.o

$(OBJDIR)/DataHandleMT.o:Classes/DataIO/DataHandleMT.f90 $(OBJDIR)/DataHandle.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataHandleMT.f90 -o $(OBJDIR)/DataHandleMT.o

$(OBJDIR)/DataHandleCSEM.o:Classes/DataIO/DataHandleCSEM.f90 $(OBJDIR)/DataHandle.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataHandleCSEM.f90 -o $(OBJDIR)/DataHandleCSEM.o

$(OBJDIR)/DataHandleFArray.o:Classes/DataIO/DataHandleFArray.f90 $(OBJDIR)/Constants.o $(OBJDIR)/DataHandleMT.o $(OBJDIR)/DataHandleCSEM.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataHandleFArray.f90 -o $(OBJDIR)/DataHandleFArray.o

$(OBJDIR)/Receiver.o:Classes/Receivers/Receiver.f90 $(OBJDIR)/String.o $(OBJDIR)/Transmitter.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/cSparseVector3D_SG.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/DataHandleFArray.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Receivers/Receiver.f90 -o $(OBJDIR)/Receiver.o

$(OBJDIR)/ReceiverFullImpedance.o:Classes/Receivers/ReceiverFullImpedance.f90 $(OBJDIR)/Receiver.o $(OBJDIR)/DataHandleMT.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Receivers/ReceiverFullImpedance.f90 -o $(OBJDIR)/ReceiverFullImpedance.o

$(OBJDIR)/ReceiverFullVerticalMagnetic.o:Classes/Receivers/ReceiverFullVerticalMagnetic.f90 $(OBJDIR)/Receiver.o $(OBJDIR)/DataHandleMT.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Receivers/ReceiverFullVerticalMagnetic.f90 -o $(OBJDIR)/ReceiverFullVerticalMagnetic.o

$(OBJDIR)/ReceiverOffDiagonalImpedance.o:Classes/Receivers/ReceiverOffDiagonalImpedance.f90 $(OBJDIR)/Receiver.o $(OBJDIR)/DataHandleMT.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Receivers/ReceiverOffDiagonalImpedance.f90 -o $(OBJDIR)/ReceiverOffDiagonalImpedance.o

$(OBJDIR)/TransmitterCSEM.o:Classes/Transmitters/TransmitterCSEM.f90 $(OBJDIR)/FileUnits.o $(OBJDIR)/Transmitter.o $(OBJDIR)/cVector3D_SG.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Transmitters/TransmitterCSEM.f90 -o $(OBJDIR)/TransmitterCSEM.o

$(OBJDIR)/ReceiverSingleField.o:Classes/Receivers/ReceiverSingleField.f90 $(OBJDIR)/Receiver.o $(OBJDIR)/DataHandleCSEM.o $(OBJDIR)/TransmitterCSEM.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Receivers/ReceiverSingleField.f90 -o $(OBJDIR)/ReceiverSingleField.o

$(OBJDIR)/ReceiverFArray.o:Classes/Receivers/ReceiverFArray.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Receiver.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Receivers/ReceiverFArray.f90 -o $(OBJDIR)/ReceiverFArray.o

$(OBJDIR)/TransmitterMT.o:Classes/Transmitters/TransmitterMT.f90 $(OBJDIR)/FileUnits.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/Transmitter.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Transmitters/TransmitterMT.f90 -o $(OBJDIR)/TransmitterMT.o

$(OBJDIR)/TransmitterFArray.o:Classes/Transmitters/TransmitterFArray.f90 $(OBJDIR)/Constants.o $(OBJDIR)/TransmitterMT.o $(OBJDIR)/TransmitterCSEM.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Transmitters/TransmitterFArray.f90 -o $(OBJDIR)/TransmitterFArray.o

$(OBJDIR)/DataFile.o:Classes/DataIO/DataFile.f90 $(OBJDIR)/Constants.o $(OBJDIR)/String.o $(OBJDIR)/DataEntryFArray.o $(OBJDIR)/DataEntryMT.o $(OBJDIR)/DataEntryMT_REF.o $(OBJDIR)/DataEntryCSEM.o $(OBJDIR)/ReceiverFullImpedance.o $(OBJDIR)/ReceiverFullVerticalMagnetic.o $(OBJDIR)/ReceiverOffDiagonalImpedance.o $(OBJDIR)/ReceiverSingleField.o $(OBJDIR)/ReceiverFArray.o $(OBJDIR)/TransmitterMT.o $(OBJDIR)/TransmitterCSEM.o $(OBJDIR)/TransmitterFArray.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataFile.f90 -o $(OBJDIR)/DataFile.o

$(OBJDIR)/DataFileStandard.o:Classes/DataIO/DataFileStandard.f90 $(OBJDIR)/DataFile.o $(OBJDIR)/DataEntryMT.o $(OBJDIR)/DataEntryMT_REF.o $(OBJDIR)/DataEntryCSEM.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/DataIO/DataFileStandard.f90 -o $(OBJDIR)/DataFileStandard.o

$(OBJDIR)/PreConditioner_MF_DC.o:Classes/ModelOperator/PreConditioner_MF_DC.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/cScalar.o $(OBJDIR)/cScalar3D_SG.o $(OBJDIR)/ModelOperator_MF.o $(OBJDIR)/PreConditioner.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/PreConditioner_MF_DC.f90 -o $(OBJDIR)/PreConditioner_MF_DC.o

$(OBJDIR)/Solver_PCG.o:Classes/Solver/Solver_PCG.f90 $(OBJDIR)/Solver.o $(OBJDIR)/cScalar.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/PreConditioner_MF_DC.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Solver/Solver_PCG.f90 -o $(OBJDIR)/Solver_PCG.o

$(OBJDIR)/DivergenceCorrection.o:Classes/ForwardSolver/DivergenceCorrection.f90 $(OBJDIR)/Solver_PCG.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/cScalar3D_SG.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/Source.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ForwardSolver/DivergenceCorrection.f90 -o $(OBJDIR)/DivergenceCorrection.o

$(OBJDIR)/PreConditioner_MF_CC.o:Classes/ModelOperator/PreConditioner_MF_CC.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid.o $(OBJDIR)/cVector.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/cScalar3D_SG.o $(OBJDIR)/ModelOperator_MF.o $(OBJDIR)/PreConditioner.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ModelOperator/PreConditioner_MF_CC.f90 -o $(OBJDIR)/PreConditioner_MF_CC.o

$(OBJDIR)/Solver_QMR.o:Classes/Solver/Solver_QMR.f90 $(OBJDIR)/Solver.o $(OBJDIR)/cVector.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/PreConditioner_MF_CC.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Solver/Solver_QMR.f90 -o $(OBJDIR)/Solver_QMR.o

$(OBJDIR)/ForwardSolverIT_DC.o:Classes/ForwardSolver/ForwardSolverIT_DC.f90 $(OBJDIR)/ForwardSolver.o $(OBJDIR)/DivergenceCorrection.o $(OBJDIR)/ModelOperator_MF.o $(OBJDIR)/Solver_QMR.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/ForwardSolver/ForwardSolverIT_DC.f90 -o $(OBJDIR)/ForwardSolverIT_DC.o

$(OBJDIR)/Forward1D.o:Classes/1D/Forward1D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid1D.o $(OBJDIR)/ModelParameter1D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/1D/Forward1D.f90 -o $(OBJDIR)/Forward1D.o

$(OBJDIR)/SourceMT_1D.o:Classes/Source/SourceMT_1D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/Source.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/ModelParameter1D.o $(OBJDIR)/Forward1D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Source/SourceMT_1D.f90 -o $(OBJDIR)/SourceMT_1D.o

$(OBJDIR)/Forward2D.o:Classes/2D/Forward2D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Grid2D.o $(OBJDIR)/ModelParameter2D.o $(OBJDIR)/Esoln2DTM.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/2D/Forward2D.f90 -o $(OBJDIR)/Forward2D.o

$(OBJDIR)/SourceMT_2D.o:Classes/Source/SourceMT_2D.f90 $(OBJDIR)/Constants.o $(OBJDIR)/Source.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/Forward2D.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Source/SourceMT_2D.f90 -o $(OBJDIR)/SourceMT_2D.o

$(OBJDIR)/FilterModules.o:Classes/CSEM/FilterModules.f90  
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/CSEM/FilterModules.f90 -o $(OBJDIR)/FilterModules.o

$(OBJDIR)/Dipole1D.o:Classes/CSEM/Dipole1D.f90 $(OBJDIR)/FilterModules.o $(OBJDIR)/FilterModules.o $(OBJDIR)/FilterModules.o $(OBJDIR)/FilterModules.o $(OBJDIR)/FilterModules.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/CSEM/Dipole1D.f90 -o $(OBJDIR)/Dipole1D.o

$(OBJDIR)/SourceCSEM_Dipole1D.o:Classes/Source/SourceCSEM_Dipole1D.f90 $(OBJDIR)/Dipole1D.o $(OBJDIR)/Constants.o $(OBJDIR)/cVector3D_SG.o $(OBJDIR)/rVector3D_SG.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/Source.o $(OBJDIR)/ModelOperator.o $(OBJDIR)/ModelParameterCell_SG.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/Source/SourceCSEM_Dipole1D.f90 -o $(OBJDIR)/SourceCSEM_Dipole1D.o

$(OBJDIR)/DeclarationMPI.o:Classes/MPI/DeclarationMPI.f90 $(OBJDIR)/Constants.o $(OBJDIR)/FileUnits.o $(OBJDIR)/ModEMControlFile.o $(OBJDIR)/Grid3D_SG.o $(OBJDIR)/ModelReader.o $(OBJDIR)/ModelReader_Weerachai.o $(OBJDIR)/ModelOperator_MF.o $(OBJDIR)/ModelOperator_File.o $(OBJDIR)/ModelParameterCell_SG.o $(OBJDIR)/DataFileStandard.o $(OBJDIR)/ForwardSolverIT_DC.o $(OBJDIR)/SourceMT_1D.o $(OBJDIR)/SourceMT_2D.o $(OBJDIR)/SourceCSEM_Dipole1D.o $(OBJDIR)/DataHandleFArray.o $(OBJDIR)/DataHandleMT.o $(OBJDIR)/DataHandleCSEM.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) Classes/MPI/DeclarationMPI.f90 -o $(OBJDIR)/DeclarationMPI.o

$(OBJDIR)/test_FWD_MPI.o:test_FWD_MPI.f90 $(OBJDIR)/DeclarationMPI.o 
	 $(F90) -c $(MODULE) $(FFLAGS) $(MPIFLAGS) test_FWD_MPI.f90 -o $(OBJDIR)/test_FWD_MPI.o

# Type " make clean " to get rid of all object and module files 
clean: 
	cd $(OBJDIR); \
	rm -f *~ *.o *.obj *.mod *.d *.s00 *.dbg *.stackdump \
	`find . -mindepth 1 -name "*~"` 

cleanall: clean 
	rm -f $(OUTDIR)/test_FWD_MPI 

src: clean 
	tar cvfz $(ARCHIVE).tgz * 

  
